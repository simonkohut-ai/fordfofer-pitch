/**
 * ğŸ¦„ FULL AUTO CEO - ROBÃM VÅ ETKO ZA TEBA
 * Automaticky generuje, commitne, pushne, deployne
 * Spustenie: node FULL_AUTO_CEO.js
 */

const fs = require('fs');
const path = require('path');
const { execSync } = require('child_process');
const cron = require('node-cron');

const POSTS_FOLDER = path.join(__dirname, '..', 'generated-posts');
const PROJECT_ROOT = path.join(__dirname, '..');

if (!fs.existsSync(POSTS_FOLDER)) {
    fs.mkdirSync(POSTS_FOLDER, { recursive: true });
}

const POST_TEMPLATES = [
    {
        emoji: 'ğŸ¦„â°',
        title: 'POSLEDNÃ‰ HODINY',
        body: `â‚¬50 cena platÃ­ len DNES.\n\nZajtra: â‚¬200\nPozajtra: Dvere zatvorenÃ©\n\n10 miest. 24 hodÃ­n.\n\nfordfofer.vercel.app/links`,
        hashtags: '#FordFofer #LastChance #Urgency #Investment #AICapital #Money'
    },
    {
        emoji: 'ğŸ¦„ğŸ“Š',
        title: 'UPDATE',
        body: `PrvÃ½ch 5 investorov uÅ¾ vstÃºpilo.\n\nPreÄo?\n\nLebo vedia Å¾e:\nâ€¢ AI je budÃºcnosÅ¥\nâ€¢ SkorÃ½ vstup = najvÃ¤ÄÅ¡Ã­ vÃ½nos\nâ€¢ â‚¬50 dnes = â‚¬200 zajtra\n\nfordfofer.vercel.app/links`,
        hashtags: '#FOMO #FordFofer #EarlyBird #Investment #Money'
    },
    {
        emoji: 'ğŸ¦„ğŸ”¥',
        title: 'HOT TAKE',
        body: `95% traderov by NEMALO obchodovaÅ¥.\n\nPreÄo?\n\nEmÃ³cie. Strach. ChamtivosÅ¥.\n\nAI nepoznÃ¡ ani jedno z tÃ½chto slov.\n\nâ‚¬50 = Lifetime prÃ­stup.\n\nfordfofer.vercel.app/links`,
        hashtags: '#UnpopularOpinion #FordFofer #AItrading #NoEmotions #Money'
    },
    {
        emoji: 'ğŸ¦„ğŸ’°',
        title: 'ÄŒO ZÃSKAÅ  ZA â‚¬50',
        body: `â†’ AI agenty 24/7\nâ†’ Zero chyba\nâ†’ $1.2B kapacita\nâ†’ Lifetime prÃ­stup\n\nÄŒo stratÃ­Å¡ ak ÄakÃ¡Å¡?\nâ‚¬150 (cena stÃºpne)\n\nfordfofer.vercel.app/links`,
        hashtags: '#Value #FordFofer #ROI #SmartInvestment #Money'
    },
    {
        emoji: 'ğŸ¦„ğŸš€',
        title: 'POSLEDNÃ‰ MIESTA',
        body: `â‚¬50 = Lifetime prÃ­stup k $1.2B AI systÃ©mu.\n\nÄŒo zÃ­skaÅ¡:\nâ†’ AI agenty 24/7\nâ†’ Zero chyba\nâ†’ Early investor status\n\nZostÃ¡va 10 miest.\n\nfordfofer.vercel.app/links`,
        hashtags: '#FordFofer #AICapital #Investment #Slovakia #Startup'
    },
    {
        emoji: 'ğŸ¦„âš¡',
        title: 'MATEMATIKA JE JASNÃ',
        body: `AI pracuje 24/7.\nTy spÃ­Å¡ 8 hodÃ­n.\n\nKto zarobÃ­ viac?\n\nâ‚¬50 vstup. Lifetime prÃ­stup.\n\nfordfofer.vercel.app/links`,
        hashtags: '#AItrading #FordFofer #PassiveIncome #SmartMoney'
    }
];

function generatePost() {
    const template = POST_TEMPLATES[Math.floor(Math.random() * POST_TEMPLATES.length)];
    return {
        text: `${template.emoji} ${template.title}\n\n${template.body}\n\n${template.hashtags}`,
        emoji: template.emoji,
        title: template.title
    };
}

function savePost(post) {
    const timestamp = new Date();
    const dateStr = timestamp.toISOString().split('T')[0];
    const timeStr = timestamp.toTimeString().split(' ')[0].replace(/:/g, '-');
    
    const filename = `post-${dateStr}-${timeStr}.txt`;
    const filepath = path.join(POSTS_FOLDER, filename);
    
    const content = `â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ¦„ POST VYGENEROVANÃ: ${timestamp.toLocaleString('sk-SK')}
â•‘  ğŸ¤– AUTO-GENERATED BY FULL AUTO CEO
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

${post.text}

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘  ğŸ“‹ SKOPÃRUJ TEXT VYÅ Å IE A POSTNI NA INSTAGRAM!
â•‘  ğŸ’¾ SÃºbor: ${filename}
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`;
    
    fs.writeFileSync(filepath, content, 'utf8');
    
    console.log(`\nâœ… POST VYGENEROVANÃ: ${filename}`);
    console.log(`ğŸ“ ${filepath}\n`);
    
    // Otvor sÃºbor
    try {
        execSync(`start notepad "${filepath}"`, { cwd: PROJECT_ROOT });
    } catch (e) {
        // Ignore errors
    }
    
    return filepath;
}

function autoCommit() {
    try {
        console.log('\nğŸ’¾ AUTO-COMMITTING...');
        execSync('git add -A', { cwd: PROJECT_ROOT, stdio: 'inherit' });
        
        const timestamp = new Date().toLocaleString('sk-SK');
        execSync(`git commit -m "Auto-generated post: ${timestamp}"`, { 
            cwd: PROJECT_ROOT, 
            stdio: 'inherit' 
        });
        
        console.log('âœ… COMMITTED\n');
    } catch (e) {
        console.log('âš ï¸ Commit skipped (no changes or git error)\n');
    }
}

function autoDeploy() {
    try {
        console.log('ğŸš€ AUTO-DEPLOYING...');
        execSync('npx vercel --prod --yes', { 
            cwd: PROJECT_ROOT, 
            stdio: 'inherit',
            timeout: 60000 
        });
        console.log('âœ… DEPLOYED\n');
    } catch (e) {
        console.log('âš ï¸ Deploy skipped (timeout or error)\n');
    }
}

function doFullCycle() {
    console.log('\n' + 'â•'.repeat(60));
    console.log('ğŸ¦„ FULL AUTO CEO - CYKLUS ZAÄŒÃNA');
    console.log('â•'.repeat(60));
    
    // 1. Generuj post
    const post = generatePost();
    const filepath = savePost(post);
    
    // 2. Commit
    autoCommit();
    
    // 3. Deploy (kaÅ¾dÃ½ 3. cyklus)
    if (Math.random() > 0.66) {
        autoDeploy();
    }
    
    console.log('âœ… CYKLUS UKONÄŒENÃ\n');
}

// Spusti prvÃ½ cyklus
doFullCycle();

// Automaticky kaÅ¾dÃ© 2 hodiny
cron.schedule('0 */2 * * *', () => {
    doFullCycle();
});

// Automaticky kaÅ¾dÃ½ deÅˆ o 8:00
cron.schedule('0 8 * * *', () => {
    console.log('\nğŸŒ… RANNÃ POST GENERUJEM...\n');
    doFullCycle();
});

// Automaticky kaÅ¾dÃ½ deÅˆ o 20:00
cron.schedule('0 20 * * *', () => {
    console.log('\nğŸŒ™ VEÄŒERNÃ POST GENERUJEM...\n');
    doFullCycle();
});

console.log(`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     ğŸ¦„ FULL AUTO CEO - BEÅ½Ã NA POZADÃ                          â•‘
â•‘                                                                â•‘
â•‘     âœ… Generuje posty kaÅ¾dÃ© 2 hodiny                          â•‘
â•‘     âœ… Commitne automaticky                                   â•‘
â•‘     âœ… Deployne pravidelne                                    â•‘
â•‘     âœ… VÅ¡etko sa robÃ­ za teba!                                â•‘
â•‘                                                                â•‘
â•‘     StlaÄ Ctrl+C pre ukonÄenie                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`);

console.log('âœ… SystÃ©m beÅ¾Ã­! Teraz len Äakaj a posty prichÃ¡dzajÃº automaticky!\n');


